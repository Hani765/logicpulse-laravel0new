{"version":3,"file":"notify-B8WPPLZs.js","sources":["../../../resources/js/Pages/notify.tsx"],"sourcesContent":["import { echoInstance } from \"@/bootstrap\";\r\nimport { User } from \"@/types\";\r\nimport { NotificationEvent } from \"@/types/global\";\r\nimport { useEffect } from \"react\";\r\nimport { toast } from \"sonner\";\r\nimport { playNotificationSound } from \"../hooks/play-audio\";\r\n\r\nconst NotificationsComponent = ({ user }: { user: User }) => {\r\n    const userId = user.unique_id;\r\n    const userRole = user.role;\r\n\r\n    useEffect(() => {\r\n        const channels: any[] = [];\r\n\r\n        // Subscribe to user-specific channel\r\n        channels.push(echoInstance.private(`notifications.${userId}`));\r\n\r\n        // Subscribe to role-specific channel\r\n        channels.push(echoInstance.private(`notifications.role.${userRole}`));\r\n\r\n        // Listen for the notification event on all channels\r\n        channels.forEach((channel) => {\r\n            channel.listen(\r\n                \".notification.sent\",\r\n                (e: { notification: NotificationEvent }) => {\r\n                    toast.message(\"New message\", {\r\n                        description: e.notification.message,\r\n                    });\r\n                    playNotificationSound(); // Play sound when notification is received\r\n                },\r\n            );\r\n        });\r\n\r\n        // Cleanup the event listeners when the component unmounts\r\n        return () => {\r\n            channels.forEach((channel) => {\r\n                channel.stopListening(\".notification.sent\");\r\n            });\r\n        };\r\n    }, [userId, userRole]); // Re-run if userId or role changes\r\n\r\n    return <div></div>;\r\n};\r\n\r\nexport default NotificationsComponent;\r\n"],"names":["NotificationsComponent","user","userId","userRole","useEffect","channels","echoInstance","channel","e","toast","playNotificationSound"],"mappings":"+FAOA,MAAMA,EAAyB,CAAC,CAAE,KAAAC,KAA2B,CACzD,MAAMC,EAASD,EAAK,UACdE,EAAWF,EAAK,KAEtBG,OAAAA,EAAAA,UAAU,IAAM,CACZ,MAAMC,EAAkB,CAAC,EAGzB,OAAAA,EAAS,KAAKC,EAAa,QAAQ,iBAAiBJ,CAAM,EAAE,CAAC,EAG7DG,EAAS,KAAKC,EAAa,QAAQ,sBAAsBH,CAAQ,EAAE,CAAC,EAG3DE,EAAA,QAASE,GAAY,CAClBA,EAAA,OACJ,qBACCC,GAA2C,CACxCC,EAAM,QAAQ,cAAe,CACzB,YAAaD,EAAE,aAAa,OAAA,CAC/B,EACqBE,EAAA,CAAA,CAE9B,CAAA,CACH,EAGM,IAAM,CACAL,EAAA,QAASE,GAAY,CAC1BA,EAAQ,cAAc,oBAAoB,CAAA,CAC7C,CACL,CAAA,EACD,CAACL,EAAQC,CAAQ,CAAC,QAEb,MAAI,EAAA,CAChB"}