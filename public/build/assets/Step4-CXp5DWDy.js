import{r as c,j as e,Y as U,B as m,J as C}from"./app-CkWx0ziT.js";import{M as R}from"./multi-select-DPI-qEqD.js";import{S as t}from"./skeleton-Dcg2qklM.js";import{R as q}from"./react-icons.esm-oGyrDKWE.js";import{S as d,a as h,b as p,c as j,d as x}from"./select-K8YH05Sy.js";import{I as E}from"./InputError-C35wS1yu.js";import{L as f}from"./label-BJBSjzRP.js";import"./badge-DKcNn6KQ.js";import"./command-Bi-o4Peo.js";import"./dialog-CMYKyR97.js";import"./index-BI6CrKg2.js";import"./search-HJj0K7uC.js";import"./checkbox-CtxrMbYo.js";import"./index-B6yvsKc-.js";import"./index-BdQq_4o_.js";import"./index-Bur4E9wJ.js";import"./chevrons-up-down-CgSDZjy1.js";import"./chevron-down-DNksLOx3.js";const F=[{label:"All",value:"all"},{label:"All Admins",value:"admins"},{label:"All Managers",value:"managers"},{label:"All Users",value:"users"}],I=[{label:"Everyone",value:"everyone"},{label:"Only Admins",value:"admins"},{label:"Only Managers",value:"managers"},{label:"Only Users",value:"users"}],J=l=>{switch(l){case"administrator":return F;case"admin":return F.filter(a=>a.value!=="admins");default:return[]}},L=l=>{switch(l){case"administrator":return I;case"admin":return I.filter(a=>a.value!=="admins");default:return[]}},ne=({formData:l,setFormData:a,errors:v,userDataFetched:g,currentStep:o,setCurrentStep:y,setUserDataFetched:A,setFetchedUsersData:S,fetchedUsersData:u,role:b})=>{const[O,N]=c.useState(!1),[T,w]=c.useState(!1),[P,V]=c.useState("all"),k=async()=>{N(!0);try{const[s,r]=await Promise.all([fetch("/fetch/all-users"),fetch("/fetch/countriesData")]);if(!s.ok||!r.ok)throw new Error("Failed to fetch data.");const[i,n]=await Promise.all([s.json(),r.json()]);S({users:i,countries:n}),A(!0)}catch{C.error("Failed to fetch data. Please try again later.")}finally{N(!1)}};c.useEffect(()=>{g||k()},[g]);const _=async s=>{w(!0),V(s);try{const r=await fetch(`/fetch/all-users?filter=${s}`);if(!r.ok)throw new Error(`HTTP error! Status: ${r.status}`);const i=await r.json();S({...u,users:i});const n=i.map(B=>B.unique_id).join(", ");a(n!==null?{...l,users_ids:n}:{...l,users_ids:""})}catch{C.error("Failed to fetch data. Please try again later.")}finally{w(!1)}},M=J(b);return e.jsxs("div",{children:[e.jsx(U,{title:"Target Details"}),O?e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsx(t,{className:"h-10"}),e.jsx(t,{className:"h-10"}),e.jsx(t,{className:"h-10"}),e.jsx(t,{className:"h-10"})]}):e.jsx("div",{className:"space-y-2 bg-white p-4 rounded dark:bg-slate-900",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"md:grid grdid-cols-1 md:grid-cols-3 gap-2",children:[e.jsxs("div",{className:"",children:[e.jsx(f,{children:"Select Status"}),e.jsxs(d,{value:l.status,onValueChange:s=>a({...l,status:s}),children:[e.jsx(h,{className:"h-10 my-1",children:e.jsx(p,{placeholder:"Select status"})}),e.jsx(j,{side:"top",children:["active","inactive","paused"].map(s=>e.jsx(x,{value:s,children:s},s))})]}),e.jsx(E,{message:v.status})]}),e.jsxs("div",{className:"",children:[e.jsx(f,{children:"Who can apply"}),e.jsxs(d,{value:l.appliableFor,onValueChange:s=>a({...l,appliableFor:s}),children:[e.jsx(h,{className:"h-10 my-1",children:e.jsx(p,{placeholder:"Select visiblity"})}),e.jsx(j,{side:"top",children:L(b).map(s=>e.jsx(x,{value:s.value,children:s.label},s.value))})]}),e.jsx(E,{message:v.appliableFor})]}),e.jsxs("div",{className:"",children:[e.jsx(f,{children:"Select Users"}),e.jsxs(d,{value:P,onValueChange:_,children:[e.jsx(h,{className:"h-10 my-1",children:e.jsx(p,{placeholder:"Select users"})}),e.jsx(j,{side:"top",children:M.map(s=>e.jsx(x,{value:s.value,children:s.label},s.value))})]})]})]}),T?e.jsx(t,{className:"h-10"}):e.jsx(R,{items:u.users,selectedItems:l.users_ids,onSelect:s=>a({...l,users_ids:s}),label:"Selected Users"}),e.jsx(R,{items:u.countries,selectedItems:l.countries,onSelect:s=>a({...l,countries:s}),label:"Select Countries"}),e.jsxs("div",{className:"flex justify-end mt-4 gap-2",children:[e.jsx(m,{variant:"outline",size:"icon",onClick:k,children:e.jsx(q,{})}),o>1&&e.jsx(m,{onClick:()=>y(o-1),children:"Back"}),e.jsx(m,{onClick:()=>y(o+1),children:"Next"})]})]})})]})};export{ne as default};
//# sourceMappingURL=Step4-CXp5DWDy.js.map
