import{r as n,J as N,j as e,Y as T,B as P}from"./app-CkWx0ziT.js";import{L as w}from"./LabelInputContainer-XQCpEK7k.js";import{L as x}from"./label-BJBSjzRP.js";import{T as R}from"./textarea-B0o24yVn.js";import{S as m}from"./skeleton-Dcg2qklM.js";import{s as y}from"./schemas-DL5d6btj.js";import{I as _}from"./InputError-C35wS1yu.js";import{I as S}from"./image-uploader-Dn9xwcOv.js";import{A}from"./index-CvH-UYLy.js";import{m as B}from"./proxy-D3ZUg4-_.js";import"./input-D_xANFY4.js";import"./use-combine-values-DXlfacMq.js";import"./tooltip-BzjTxjM0.js";import"./index-Bur4E9wJ.js";import"./react-icons.esm-oGyrDKWE.js";import"./index-BVh6SYYr.js";import"./credenza-3netIWa9.js";import"./dialog-CMYKyR97.js";import"./index-BI6CrKg2.js";import"./SubmitBtn-BLHHLASd.js";import"./profile_pic-BgAzqiSS.js";import"./circle-user-D2Z5yh8B.js";const J=(s,i)=>{let l;return(...o)=>{clearTimeout(l),l=setTimeout(()=>{s(...o)},i)}},le=({formData:s,setFormData:i,errors:l,showMeta:o,setShowMeta:c,currentStep:k,setCurrentStep:C})=>{const[d,g]=n.useState(null),[E,u]=n.useState(!1),[p,j]=n.useState({}),b=n.useCallback(async t=>{u(!0),c(!1);try{const r=await fetch(`/fetch-metadata?url=${encodeURIComponent(t)}`);if(!r.ok)throw new Error("Failed to fetch metadata");const a=await r.json();i({...s,main_url:t,title:a.title,description:a.description,keywords:a.keywords,image:a.image}),c(!0),u(!1)}catch{N.error("Failed to fetch metadata for this URL! Please enter manually or check the URL."),u(!1),c(!0)}},[i,c,s]),f=n.useCallback(J(b,500),[b]),U=t=>{const r=t.target.value;if(r!==s.main_url){i({...s,main_url:r});const a=y.shape.main_url.safeParse(r);a.success?(g(null),f(r)):(g(a.error.errors[0].message),c(!1))}},I=()=>{var r,a,v;const t=y.safeParse(s);if(!t.success){const h=t.error.format();return j({main_url:((r=h.main_url)==null?void 0:r._errors[0])||null,title:((a=h.title)==null?void 0:a._errors[0])||null,description:((v=h.description)==null?void 0:v._errors[0])||null}),!1}return j({}),!0},L=()=>{I()?C(k+1):N.error("Please fix the validation errors.")};return n.useEffect(()=>{s.main_url&&!d&&!o&&f(s.main_url)},[s.main_url,d,o,f]),e.jsxs("div",{children:[e.jsx(T,{title:"Basic Information"}),e.jsx("div",{className:"bg-white dark:bg-slate-900 p-2 rounded",children:e.jsx(w,{label:"Offer URL",helperText:"www.offer1.com?o=1&p=2",type:"url",onChange:U,value:s.main_url,errorMessage:d||p.main_url||"",bottomMessage:"Paste offer url to help us to fetch metadata of offer."})}),e.jsx(A,{children:o&&e.jsxs(B.div,{className:"mt-4 space-y-2",initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:50},transition:{duration:.5},children:[e.jsx("h3",{className:"font-semibold",children:"Metadata Details:"}),e.jsx("div",{className:"bg-white dark:bg-slate-900 p-2 rounded",children:e.jsx(w,{label:"Title",helperText:"eg: Offer 1 - An awesome offer",type:"text",value:s.title,errorMessage:p.title||l.title||"",onChange:t=>i({...s,title:t.target.value})})}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-2 rounded",children:[e.jsx(x,{children:"Description"}),e.jsx(R,{value:s.description,placeholder:"Something about offer....",onChange:t=>i({...s,description:t.target.value})}),e.jsx(_,{message:l.description||p.description})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-2 rounded flex justify-between items-center",children:[e.jsxs("div",{className:"",children:[e.jsx(x,{children:"Upload or Change Image"}),e.jsx("p",{className:"text-sm",children:"Upload a new image for this offer meta!"})]}),e.jsx(S,{selected_image:s.image,onUpload:t=>i({...s,image:t})})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-2 rounded",children:[e.jsx(x,{children:"Image"}),e.jsx("img",{src:s.image,alt:s.image,className:"w-full h-[400px]"}),e.jsx(_,{message:l.image})]}),e.jsx("div",{className:"flex w-full justify-end items-center mt-4",children:e.jsx(P,{onClick:L,className:"mr-2",children:"Next"})})]})}),E&&e.jsxs("div",{className:"w-full space-y-2 mt-4",children:[e.jsx(m,{className:"w-full h-12"}),e.jsx(m,{className:"w-full h-20"}),e.jsx(m,{className:"w-full h-48"}),e.jsx(m,{className:"w-full h-20"})]})]})};export{le as default};
//# sourceMappingURL=Step1-CqWEAUiU.js.map
