import{r as o,q as j,a1 as g,J as C,j as e}from"./app-CkWx0ziT.js";import{P as w}from"./page-chart-DUwi3Qbb.js";import{D as y}from"./table-CRgLH--_.js";import{S as b,D as S}from"./tableSkeleton-C84tRfxU.js";import{p as k}from"./play-audio-DP9JVqAd.js";import{Columns as P}from"./columns-DOCA-99Z.js";import D from"./create-BbxFnfiT.js";const x=o.createContext(void 0),q=({url:s,children:d})=>{const[n,t]=o.useState(null),[a,i]=o.useState(null),[l,u]=o.useState(!0),h=j(),m=h.props.auth.user.unique_id,p=h.props.auth.user.role,f=async()=>{u(!0);try{const r=await fetch(s);if(!r.ok)throw new Error(`HTTP error! Status: ${r.status}`);const c=await r.json();t(c)}catch(r){i(r)}finally{u(!1)}};return o.useEffect(()=>{f();const r=[g.private(`clickConversion.${m}`),g.private(`clickConversion.role.${p}`)];return r.forEach(c=>c.listen(".clickConversion.sent",v=>{v.clickConversion.message==="conversion"&&(k(),C.message("New message",{description:"A new conversion has been received"}),f())})),()=>r.forEach(c=>c.stopListening(".clickConversion.sent"))},[m,p,s]),e.jsx(x.Provider,{value:{data:n,error:a,isLoading:l},children:d})},E=()=>{const s=o.useContext(x);if(!s)throw new Error("useFetchContext must be used within a FetchProvider");return s},F=({url:s,setUrl:d,role:n})=>{const{data:t,error:a,isLoading:i}=E();return i?e.jsx("div",{children:"Loading..."}):a?e.jsxs("div",{children:["Error: ",a.message]}):e.jsxs("div",{children:[e.jsx("h1",{children:"Fetched Data"}),a?e.jsxs("div",{className:"min-h-72 mt-6 bg-white flex border flex-col border-gray-200 dark:border-gray-700 dark:bg-gray-900 w-full shadow-sm justify-center items-center px-2 rounded py-4 text-gray-100 dark:text-gray-600",children:[e.jsx(b,{size:44}),e.jsx("div",{children:"Something went wrong please try to refresh the page."})]}):t?e.jsxs(e.Fragment,{children:[e.jsx(w,{data:t==null?void 0:t.chart_data,isLoading:i}),e.jsx(y,{isLoading:i,data:t.data,pagination:t.pagination,endPoint:s,columns:P(n),onUrlChange:l=>d(l),isPagination:!0,Create:n==="admin"||n==="administrator"?D:void 0})]}):e.jsx(S,{rowCount:8,columnCount:8,showViewOptions:!1})]})},z=Object.freeze(Object.defineProperty({__proto__:null,DataPage:F},Symbol.toStringTag,{value:"Module"}));export{F as D,q as F,z as d};
//# sourceMappingURL=data-BcsMB4PZ.js.map
